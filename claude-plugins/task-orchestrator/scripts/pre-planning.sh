#!/usr/bin/env bash
# PreToolUse hook for EnterPlanMode: Guides structured planning with template discovery.

cat <<'EOF'
{"hookSpecificOutput":{"hookEventName":"PreToolUse","additionalContext":"Planning mode activated. Follow this planning workflow:\n\n1. SIZE the work: Project + Features + Tasks (large multi-feature efforts), Feature + Tasks (focused scope, most common), or Standalone Tasks (small items).\n\n2. DISCOVER templates: Call query_templates for both FEATURE and TASK types. Match available templates to the user's request. If the user specified templates, confirm those exist.\n\n3. ASK the user via AskUserQuestion: Confirm the container type and which templates to apply. Example: 'I recommend a Feature with Requirements Specification template, and 3 tasks using Task Implementation. Sound right?'\n\n4. WRITE the plan using template sections as the minimum structure (floor, not ceiling). Add additional sections, analysis, or content beyond what the templates provide wherever it adds value. Templates define the baseline; your expertise fills in the rest. Include for each task: title, priority, complexity estimate, and which tasks it depends on. The plan should read as the full container hierarchy the user will see after approval.\n\n5. REVISION CHECK: If plan.md already contains an MCP Container UUID line, this is a revision. Skip template discovery and focus on what changed.\n\nThe plan.md is the source of truth during planning. MCP containers are created only after the user approves."}}
EOF
