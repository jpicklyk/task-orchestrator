# AI Agent Configuration for Task Orchestrator
# This file maps task characteristics to specialized AI agents
#
# Architecture: Direct specialist pattern - orchestrator routes tasks directly to specialists
# using recommend_agent() tool. No intermediary Feature Manager or Task Manager agents.
#
# For detailed documentation, see: docs/agent-orchestration.md
#
# Recommended section tags:
#   - requirements: What needs to be built
#   - technical-approach: How to build it
#   - implementation: Implementation details
#   - testing-strategy: Testing approach
#   - context: Background information
#   - documentation: User-facing docs

# Parallel Processing Configuration
# Supports launching multiple specialist agents concurrently for independent tasks
# when dependencies allow parallel execution.
parallelProcessing:
  # Maximum number of tasks that can be processed in parallel
  # Orchestrator can recommend up to this many unblocked tasks per batch
  maxParallelTasks: 5

  # Agents that support parallel execution workflows
  capabilities:
    # Feature Architect - Designs features and creates initial task breakdown
    - agent: Feature Architect
      supportsParallel: false
      description: "Creates features with structured task breakdowns"

    # Planning Specialist - Creates detailed task breakdowns with dependency metadata
    - agent: Planning Specialist
      supportsParallel: false
      description: "Creates dependency-aware task breakdowns for parallel execution"

    # Specialist Agents - All specialists can run concurrently for independent tasks
    - agent: Backend Engineer
      supportsParallel: true
      concurrent: true
      description: "Backend implementation - can run in parallel with other specialists"

    - agent: Frontend Developer
      supportsParallel: true
      concurrent: true
      description: "Frontend implementation - can run in parallel with other specialists"

    - agent: Database Engineer
      supportsParallel: true
      concurrent: true
      description: "Database work - can run in parallel with other specialists"

    - agent: Test Engineer
      supportsParallel: true
      concurrent: true
      description: "Testing work - can run in parallel with other specialists"

    - agent: Technical Writer
      supportsParallel: true
      concurrent: true
      description: "Documentation - can run in parallel with other specialists"

# Map workflow activities to agents
# Agent names must match Claude Code subagent_type format (Proper Case with spaces)
workflowPhases:
  feature-authoring: Feature Architect
  bug-triage: Bug Triage Specialist
  task-breakdown: Planning Specialist
  documentation: Technical Writer
  review: Technical Writer

# ============================================================================
# TAG MAPPING MAINTENANCE GUIDE
# ============================================================================
#
# HOW TAG MAPPING WORKS:
# - When tasks are created with tags, recommend_agent() checks this file
# - If ANY task tag matches a mapping, that agent is recommended
# - First match in tagPriority order wins (see tagPriority section below)
#
# WHEN TO ADD NEW MAPPINGS:
# - Feature Architect creates features with new domain tags (mobile, devops, security)
# - Tasks created with specialized tags not yet mapped to agents
# - Monthly review of unmapped tags using list_tags() tool
#
# HOW TO ADD NEW MAPPINGS:
# 1. Identify the new tag(s) and determine appropriate specialist agent
# 2. Add new entry to tagMappings section below:
#
#    - task_tags: [your-new-tag, related-tag, synonym-tag]
#      agent: Specialist Agent Name
#      section_tags: [relevant, section, tags]
#
# 3. Update tagPriority section if needed (controls conflict resolution)
# 4. Commit changes to git (agents read this file at runtime)
#
# EXAMPLE - Adding mobile development support:
#
#    - task_tags: [mobile, ios, android, react-native, flutter]
#      agent: Mobile Developer
#      section_tags: [requirements, technical-approach, ui-design]
#
# BEST PRACTICES:
# - Use kebab-case for tags: mobile-app, not mobileApp or mobile_app
# - Include synonyms: [mobile, ios, android] covers all mobile platforms
# - Group related technologies: [database, sql, postgres, mysql, mongodb]
# - Update tagPriority when adding high-priority domains (security, bug fixes)
# - Test mapping with recommend_agent(taskId) after adding
#
# DISCOVERY:
# - Find unmapped tags: list_tags(sortBy="count", sortDirection="desc")
# - Check tag usage: get_tag_usage(tag="your-tag")
# - Review existing mappings below for patterns
#
# ============================================================================

# Map task tags to specialized agents
# Agents will be recommended based on task tags matching these patterns
# section_tags specify which section tags the agent should query for efficient context
tagMappings:
  - task_tags: [backend, api, service, kotlin, rest]
    agent: Backend Engineer
    section_tags: [requirements, technical-approach, implementation]

  - task_tags: [frontend, ui, react, vue, angular, web]
    agent: Frontend Developer
    section_tags: [requirements, technical-approach, design, ux]

  - task_tags: [database, migration, schema, sql, flyway]
    agent: Database Engineer
    section_tags: [requirements, technical-approach, data-model]

  - task_tags: [testing, test, qa, quality, coverage]
    agent: Test Engineer
    section_tags: [requirements, testing-strategy, acceptance-criteria]

  - task_tags: [documentation, docs, user-docs, api-docs, guide, readme]
    agent: Technical Writer
    section_tags: [requirements, context, documentation]

  - task_tags: [bug, bugfix, regression, defect, issue]
    agent: Bug Triage Specialist
    section_tags: [bug-report, reproduction, impact]

  - task_tags: [feature-creation, feature-authoring, requirements-gathering, concept]
    agent: Feature Architect
    section_tags: [context, requirements, business]

  - task_tags: [planning, task-breakdown, specification, architecture, design]
    agent: Planning Specialist
    section_tags: [context, requirements, technical-approach]

# Priority order when multiple tags match (first match wins)
tagPriority:
  - bug
  - database
  - backend
  - frontend
  - testing
  - documentation
  - planning

# Entity type specific mappings
entityTypes:
  FEATURE:
    # Feature creation and structuring
    authoring: Feature Architect
    # Task breakdown from feature
    breakdown: Planning Specialist

  TASK:
    # Tasks use tag-based selection during implementation
    # No specific agent for general tasks (uses main Claude Code instance)
    fallback: null

# ============================================================================
# FALLBACK CONFIGURATION
# ============================================================================
# Default specialist when recommend_agent() finds no matching tags

# Default specialist for unmatched tasks
default_specialist: "general-purpose"

# Fallback behavior when no specialist matched
fallback_behavior: "use_default"  # Options: use_default, ask_user, skip
# - use_default: Automatically use default_specialist
# - ask_user: Prompt user to select specialist
# - skip: Don't assign specialist, return no recommendation

# ============================================================================
# ORCHESTRATION CONFIGURATION
# ============================================================================
# Additional configuration for orchestration workflows

orchestration:
  # Enable smart routing based on task complexity
  complexity_routing:
    enabled: true
    thresholds:
      simple: 4      # <= 4 complexity: Consider direct tools or skills
      moderate: 7    # 5-7 complexity: Use specialists (standard)
      complex: 10    # 8-10 complexity: Always use specialists, may need breakdown

  # Parallel execution hints for Task Orchestration Skill
  parallel_hints:
    database_first: true    # Prioritize database tasks in early batches
    ui_independent: true    # UI tasks can run parallel with backend
    tests_last: true        # Testing tasks depend on implementation
    docs_parallel: true     # Documentation can run parallel with implementation

  # Status progression hints
  status_hints:
    auto_progress_simple: true       # Auto-progress simple tasks
    require_summary: true            # Require summary before task completion
    validate_dependencies: true      # Check dependencies before starting

  # Quality gate integration
  quality_gates:
    enforce_before_completion: true  # Enforce quality gates
    testing_required: true           # Require tests for completion
    documentation_required: false    # Don't require docs for all tasks
