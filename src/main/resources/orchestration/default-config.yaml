# Task Orchestrator Configuration
# This file configures orchestration behavior, status progressions, and quality gates
# Version: 2.0.0
#
# IMPLEMENTATION STATUS LEGEND:
# âœ… IMPLEMENTED - Feature is actively used by the codebase
# âš ï¸ PARTIAL - Feature is partially implemented or referenced
# âŒ NOT IMPLEMENTED YET - Configuration defined for future use
#
# See: docs/configuration-status.md for detailed implementation status

version: "2.0.0"

# ============================================================================
# STATUS PROGRESSION CONFIGURATION (âœ… IMPLEMENTED)
# ============================================================================
# Define allowed status flows for features and tasks
# Progression typically moves forward, but can move backward for rework
#
# IMPLEMENTATION: StatusValidator.kt loads and enforces these workflows
# NOTE: This config activates v2.0 mode when setup_claude_orchestration tool is run.
# Without this config, system uses legacy v1.0 enum-based validation.

# ============================================================================
# WHAT CAN YOU EDIT?
# ============================================================================
# âœ… SAFE TO CUSTOMIZE (encouraged):
#    - Flow sequences (default_flow, custom flows like bug_fix_flow, etc.)
#    - flow_mappings (add your own, delete provided ones, change tags)
#    - emergency_transitions (which statuses are emergency)
#    - terminal_statuses (which statuses end the workflow)
#
# âš ï¸ EDIT WITH CAUTION (understand implications):
#    - Status names in flows (system uses kebab-case: in-progress, not IN_PROGRESS)
#    - status_validation rules (affects workflow strictness)
#
# âŒ DO NOT REMOVE (required by system):
#    - version field (top of file)
#    - status_progression section
#    - At least one flow per entity type (default_flow recommended)
#    - terminal_statuses list (can be empty but must exist)
#
# ðŸ’¡ FLOW MAPPINGS ARE USER-DEFINED:
#    The flow_mappings provided below (bug_fix_flow, documentation_flow, etc.)
#    are STARTER EXAMPLES. You can:
#    - Delete any or all of them
#    - Create your own custom flows and mappings
#    - Change tags to match your team's conventions
#    - Add as many custom flows as you need

# ----------------------------------------------------------------------------
# STATUS DEFINITIONS (Reference Only - DO NOT EDIT)
# ----------------------------------------------------------------------------
# All valid statuses across entity types with descriptions.
# These are hardcoded in the system enums. You cannot add new statuses,
# but you can use any subset of these in your flows.

# FEATURE STATUSES (10 total):
# - draft: Initial draft state for exploring ideas and rough requirements
# - planning: Defining detailed requirements, breaking down into tasks
# - in-development: Active implementation of tasks by specialists
# - testing: All development tasks complete, running test suite
# - validating: Tests passed, performing final validation before completion
# - pending-review: Awaiting human review/approval before marking complete
# - blocked: Blocked by external dependencies or technical issues (emergency)
# - on-hold: Temporarily paused due to priority/resource changes (emergency)
# - completed: Feature complete, validated, and delivered (terminal)
# - archived: Archived for historical reference (emergency, terminal)

# TASK STATUSES (11 total):
# - backlog: Task in backlog awaiting prioritization
# - pending: Task ready to start, waiting for specialist assignment
# - in-progress: Task actively being worked on by specialist
# - in-review: Implementation complete, awaiting code review
# - changes-requested: Review completed with requested changes
# - testing: Implementation complete, running automated tests or QA
# - blocked: Blocked by incomplete dependencies or external issues (emergency)
# - on-hold: Temporarily paused due to resource/priority changes (emergency)
# - completed: Task finished, validated, and merged (terminal)
# - cancelled: Task explicitly cancelled (terminal)
# - deferred: Task postponed indefinitely (terminal)

# PROJECT STATUSES (6 total):
# - planning: Defining project scope, features, timeline
# - in-development: Active development of features
# - on-hold: Project temporarily paused (emergency)
# - cancelled: Project cancelled or abandoned (emergency, terminal)
# - completed: Project finished and delivered (terminal)
# - archived: Archived for historical reference (terminal)

status_progression:
  features:
    # Default flow for software development
    default_flow:
      - draft              # Initial draft, rough ideas
      - planning           # Define requirements, break into tasks
      - in-development     # Active implementation
      - testing            # All tasks complete, running tests
      - validating         # Tests passed, final validation
      - completed          # Feature complete and validated

    # Alternative flow with review gate
    with_review_flow:
      - draft
      - planning
      - in-development
      - testing
      - validating
      - pending-review     # Awaiting human approval
      - completed

    # Rapid prototyping flow (skip planning and testing)
    rapid_prototype_flow:
      - draft
      - in-development
      - completed

    # Tag-based flow mappings (âœ… IMPLEMENTED)
    # Automatically selects workflow based on feature tags
    #
    # ðŸ’¡ THESE ARE STARTER EXAMPLES - CUSTOMIZE FOR YOUR TEAM:
    # You can delete these, modify the tags, or create entirely new mappings.
    # The system will use default_flow if no tags match.
    flow_mappings:
      - tags: [prototype, poc, spike]
        flow: rapid_prototype_flow
      - tags: [needs-review, stakeholder-approval]
        flow: with_review_flow

    # Statuses that can be entered from any state
    emergency_transitions:
      - blocked           # Feature blocked (can happen anytime)
      - on-hold           # Feature paused (can happen anytime)
      - archived          # Feature archived (can happen anytime)

    # Terminal statuses (no progression from these)
    terminal_statuses:
      - completed
      - archived

  tasks:
    # Default task flow
    default_flow:
      - backlog            # Task in backlog, needs prioritization
      - pending            # Task ready, waiting to start
      - in-progress        # Actively being worked on
      - testing            # Implementation complete, running tests
      - completed          # Task complete

    # Flow with code review gate (supports unlimited review iterations)
    with_review:
      - backlog
      - pending
      - in-progress
      - in-review          # Awaiting code review
      - testing            # Review approved, testing
      - completed
    # Iteration pattern with allow_backward: true:
    # - in-review â†’ in-progress (backward if changes needed)
    # - in-progress â†’ in-review (forward for re-review)
    # - Supports unlimited review rounds via backward movement

    # Bug fix flow (skip backlog for urgent fixes)
    bug_fix_flow:
      - pending            # Bug reported, ready to fix
      - in-progress        # Fixing bug
      - testing            # Testing fix
      - completed          # Bug fixed

    # Documentation flow (skip testing for non-code tasks)
    documentation_flow:
      - pending
      - in-progress
      - in-review          # Documentation review
      - completed

    # Hotfix flow (emergency fixes, skip backlog and review)
    hotfix_flow:
      - pending
      - in-progress
      - completed

    # Tag-based flow mappings (âœ… IMPLEMENTED)
    # Automatically selects workflow based on task tags
    #
    # ðŸ’¡ THESE ARE STARTER EXAMPLES - CUSTOMIZE FOR YOUR TEAM:
    # You can delete these, modify the tags, or create entirely new mappings.
    # The system will use default_flow if no tags match.
    flow_mappings:
      - tags: [bug, bugfix, fix]
        flow: bug_fix_flow
      - tags: [documentation, docs]
        flow: documentation_flow
      - tags: [hotfix, emergency, critical]
        flow: hotfix_flow
      - tags: [needs-review, code-review]
        flow: with_review

    # Terminal statuses (no progression from these)
    terminal_statuses:
      - completed
      - cancelled
      - deferred

  projects:
    # Default project flow
    default_flow:
      - planning           # Define scope and features
      - in-development     # Active development
      - completed          # Project finished
      - archived           # Archive for history

    # Statuses that can be entered from any state
    emergency_transitions:
      - on-hold           # Project paused (can happen anytime)
      - cancelled         # Project cancelled (can happen anytime)

    # Terminal statuses
    terminal_statuses:
      - completed
      - archived
      - cancelled

# ============================================================================
# STATUS VALIDATION RULES (âœ… IMPLEMENTED)
# ============================================================================
# Advanced validation rules for status transitions
#
# IMPLEMENTATION: StatusValidator.kt enforces these rules when config is present
# The validator supports flexible workflows with safety guardrails

status_validation:
  # Enforce strict sequential flow (can't skip statuses in defined flows)
  # When true: Must follow default_flow or alternative flows step-by-step
  # When false: Can jump to any allowed status
  #
  # Recommendation: Keep true for teams needing process compliance
  enforce_sequential: true

  # Allow backward transitions (e.g., testing â†’ in-progress for rework)
  # When true: Can move backwards in flow to fix issues
  # When false: Can only move forward
  #
  # Recommendation: Keep true for iterative development workflows
  allow_backward: true

  # Allow emergency transitions (blocked, on-hold, archived, cancelled, deferred)
  # When true: Can enter emergency_transitions from any state
  # When false: Emergency statuses follow normal flow rules
  #
  # Recommendation: Keep true to handle unexpected blockers and priority shifts
  allow_emergency: true

  # Validate prerequisites before status change (feature must have tasks, etc.)
  # When true: Enforces business rules like "feature needs tasks before completion"
  # When false: Allows status changes without prerequisite checks
  #
  # Recommendation: Keep true to prevent incomplete work from being marked complete
  validate_prerequisites: true

# ============================================================================
# PARALLEL EXECUTION SETTINGS (âŒ NOT IMPLEMENTED YET)
# ============================================================================
# Configure how tasks are executed in parallel based on dependencies
#
# PLANNED: Future parallel execution engine for concurrent task processing
# CURRENT: No code reads these settings; parallel execution is manual

parallelism:
  enabled: true                    # Enable parallel task execution
  max_parallel_tasks: 5            # Maximum concurrent tasks
  auto_launch: true                # Auto-launch parallel batches (false = suggest only)
  monitor_interval: 30             # Progress check interval (seconds)

# ============================================================================
# WORKFLOW AUTOMATION (âŒ NOT IMPLEMENTED YET)
# ============================================================================
# Configure automatic workflow behaviors
#
# PLANNED: Automated task creation, specialist assignment, status progression
# CURRENT: No automation engine reads these settings; all actions are manual

automation:
  # Feature and task creation
  auto_create_tasks: true          # Auto-create tasks for simple features
  auto_assign_specialists: true    # Auto-assign specialists based on tags
  auto_progress_status: true       # Auto-progress status when conditions met
  auto_complete_features: false    # Require manual confirmation for completion

  # Template management
  templates:
    auto_discover: true            # Auto-discover available templates
    auto_apply: true               # Auto-apply templates to new entities
    required: []                   # Required template names
    # Example:
    # required:
    #   - "Technical Approach"
    #   - "Testing Strategy"

# ============================================================================
# FEATURE-SPECIFIC SETTINGS
# ============================================================================

# Complexity thresholds for routing decisions (âš ï¸ REFERENCED but not loaded)
# NOTE: These values are documented in Skills but not loaded by backend code
complexity:
  simple_threshold: 4              # Complexity â‰¤ 4 = simple task
  moderate_threshold: 7            # Complexity 5-7 = moderate task
  complex_threshold: 10            # Complexity 8-10 = complex task

# Feature creation thresholds (âš ï¸ REFERENCED but not loaded)
# NOTE: These values are documented in Skills but not loaded by backend code
feature_creation:
  simple_max_tasks: 3              # Max tasks for "simple" feature
  simple_max_description: 200      # Max chars for "simple" feature
  complex_min_tasks: 5             # Min tasks for "complex" feature

# Dependency management (âŒ NOT IMPLEMENTED YET)
dependencies:
  auto_detect_circular: true       # Auto-detect circular dependencies
  warn_on_deep_chains: true        # Warn when dependency chains > 5 levels
  max_dependency_depth: 10         # Maximum allowed dependency depth
