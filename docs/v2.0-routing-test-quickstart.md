# v2.0 Routing Test - Quick Start Guide

**Quick reference for running routing validation tests**

---

## Prerequisites

1. ✅ v2.0 architecture committed to feature/2.0.0-beta branch
2. ⬜ Run `setup_claude_orchestration` MCP tool to install agents and skills
3. ⬜ MCP server running with latest code

---

## Quick Test Sequence

### Step 1: Create Test Project & Feature

```javascript
// Create test project
const project = manage_container({
  operation: "create",
  containerType: "project",
  name: "v2.0 Routing Test Project",
  status: "active"
})

// Create test feature
const feature = manage_container({
  operation: "create",
  containerType: "feature",
  name: "Authentication System",
  description: "Test feature for validating v2.0 routing",
  projectId: project.id,
  status: "planning",
  priority: "high"
})
```

### Step 2: Create Test Tasks (Copy & Paste)

**Backend Task:**
```javascript
const backendTask = manage_container({
  operation: "create",
  containerType: "task",
  title: "TEST: Implement auth API",
  description: "Backend authentication endpoints",
  featureId: "FEATURE_ID_HERE",
  tags: "backend,api,rest",
  priority: "high",
  complexity: 6
})
```

**Frontend Task:**
```javascript
const frontendTask = manage_container({
  operation: "create",
  containerType: "task",
  title: "TEST: Create login UI",
  description: "React login component",
  featureId: "FEATURE_ID_HERE",
  tags: "frontend,ui,react",
  priority: "medium",
  complexity: 5
})
```

**Database Task:**
```javascript
const dbTask = manage_container({
  operation: "create",
  containerType: "task",
  title: "TEST: Add user table",
  description: "Database migration for users",
  featureId: "FEATURE_ID_HERE",
  tags: "database,migration,schema",
  priority: "high",
  complexity: 4
})
```

**Testing Task:**
```javascript
const testTask = manage_container({
  operation: "create",
  containerType: "task",
  title: "TEST: Auth integration tests",
  description: "Test authentication flow",
  featureId: "FEATURE_ID_HERE",
  tags: "testing,integration-test,qa",
  priority: "high",
  complexity: 6
})
```

**Documentation Task:**
```javascript
const docTask = manage_container({
  operation: "create",
  containerType: "task",
  title: "TEST: API documentation",
  description: "Document auth endpoints",
  featureId: "FEATURE_ID_HERE",
  tags: "documentation,api-docs",
  priority: "medium",
  complexity: 3
})
```

**Bug Task (Senior Engineer):**
```javascript
const bugTask = manage_container({
  operation: "create",
  containerType: "task",
  title: "TEST: Fix NPE in UserService",
  description: "NullPointerException on login",
  featureId: "FEATURE_ID_HERE",
  tags: "bug,error,backend",
  priority: "high",
  complexity: 6
})
```

**Complex Task (Senior Engineer):**
```javascript
const complexTask = manage_container({
  operation: "create",
  containerType: "task",
  title: "TEST: Refactor auth architecture",
  description: "Architectural redesign needed",
  featureId: "FEATURE_ID_HERE",
  tags: "complex,refactor,architecture",
  priority: "medium",
  complexity: 9
})
```

### Step 3: Test Routing for Each Task

**Run recommend_agent for each task:**

```javascript
// Test backend routing
const backendRec = recommend_agent(taskId: backendTask.id)
console.log("Backend Task Routing:")
console.log("- Agent:", backendRec.agent)
console.log("- Skills:", backendRec.nextAction?.skills_loaded)
console.log("- Expected: Implementation Specialist + backend-implementation")
console.log("")

// Test frontend routing
const frontendRec = recommend_agent(taskId: frontendTask.id)
console.log("Frontend Task Routing:")
console.log("- Agent:", frontendRec.agent)
console.log("- Skills:", frontendRec.nextAction?.skills_loaded)
console.log("- Expected: Implementation Specialist + frontend-implementation")
console.log("")

// Test database routing
const dbRec = recommend_agent(taskId: dbTask.id)
console.log("Database Task Routing:")
console.log("- Agent:", dbRec.agent)
console.log("- Skills:", dbRec.nextAction?.skills_loaded)
console.log("- Expected: Implementation Specialist + database-implementation")
console.log("")

// Test testing routing
const testRec = recommend_agent(taskId: testTask.id)
console.log("Testing Task Routing:")
console.log("- Agent:", testRec.agent)
console.log("- Skills:", testRec.nextAction?.skills_loaded)
console.log("- Expected: Implementation Specialist + testing-implementation")
console.log("")

// Test documentation routing
const docRec = recommend_agent(taskId: docTask.id)
console.log("Documentation Task Routing:")
console.log("- Agent:", docRec.agent)
console.log("- Skills:", docRec.nextAction?.skills_loaded)
console.log("- Expected: Implementation Specialist + documentation-implementation")
console.log("")

// Test bug routing (Senior Engineer)
const bugRec = recommend_agent(taskId: bugTask.id)
console.log("Bug Task Routing:")
console.log("- Agent:", bugRec.agent)
console.log("- Skills:", bugRec.nextAction?.skills_loaded || "N/A")
console.log("- Expected: Senior Engineer (no Skills)")
console.log("")

// Test complex routing (Senior Engineer)
const complexRec = recommend_agent(taskId: complexTask.id)
console.log("Complex Task Routing:")
console.log("- Agent:", complexRec.agent)
console.log("- Skills:", complexRec.nextAction?.skills_loaded || "N/A")
console.log("- Expected: Senior Engineer (no Skills)")
```

### Step 4: Validation Checklist

For each test, verify:

**Implementation Specialist Tasks:**
- ✅ Agent = "Implementation Specialist"
- ✅ Correct Skill loaded (backend-implementation, frontend-implementation, etc.)
- ✅ sectionTags appropriate for domain
- ✅ nextAction includes tool="Task" and subagent_type="Implementation Specialist"

**Senior Engineer Tasks:**
- ✅ Agent = "Senior Engineer"
- ✅ No Skills loaded (Senior Engineer doesn't use Skills)
- ✅ Reason mentions debugging/complexity/bug-fixing
- ✅ nextAction includes subagent_type="Senior Engineer"

---

## Expected Results Summary

| Task Type | Expected Agent | Expected Skills | Model |
|-----------|---------------|-----------------|-------|
| Backend | Implementation Specialist | backend-implementation | Haiku |
| Frontend | Implementation Specialist | frontend-implementation | Haiku |
| Database | Implementation Specialist | database-implementation | Haiku |
| Testing | Implementation Specialist | testing-implementation | Haiku |
| Documentation | Implementation Specialist | documentation-implementation | Haiku |
| Bug | Senior Engineer | None | Sonnet |
| Complex | Senior Engineer | None | Sonnet |
| Blocker | Senior Engineer | None | Sonnet |

---

## Common Issues & Troubleshooting

### Issue: recommend_agent returns "no recommendation"
**Cause:** Task tags don't match agent-mapping-v2.yaml
**Fix:** Check task tags, verify agent-mapping-v2.yaml loaded

### Issue: Wrong Skill loaded
**Cause:** Tag priority or mapping issue
**Fix:** Review agent-mapping-v2.yaml tag mappings

### Issue: Senior Engineer not recommended for bugs
**Cause:** Bug tags not in agent-mapping-v2.yaml
**Fix:** Add bug tags to Senior Engineer mapping

### Issue: Skills not loading for Implementation Specialist
**Cause:** Skill files not in correct location
**Fix:** Verify .claude/skills/*/SKILL.md exist after setup_claude_orchestration

---

## Cleanup After Testing

```javascript
// Delete test project (cascades to feature and tasks)
manage_container({
  operation: "delete",
  containerType: "project",
  id: project.id,
  force: true
})
```

---

## Quick Pass/Fail

Record results:

- [ ] Backend → Implementation Specialist + backend-implementation
- [ ] Frontend → Implementation Specialist + frontend-implementation
- [ ] Database → Implementation Specialist + database-implementation
- [ ] Testing → Implementation Specialist + testing-implementation
- [ ] Documentation → Implementation Specialist + documentation-implementation
- [ ] Bug → Senior Engineer (no Skills)
- [ ] Complex → Senior Engineer (no Skills)

**Overall Result:** [ ] PASS  [ ] FAIL

**Notes:**
